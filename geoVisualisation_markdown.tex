\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Geo\_Visualisation},
            pdfauthor={Nahku Saidy},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Geo\_Visualisation}
\author{Nahku Saidy}
\date{1/19/2020}

\begin{document}
\maketitle

Einbinden der benötigten Bibliotheken

\hypertarget{geo-visualisierung}{%
\section{Geo-Visualisierung}\label{geo-visualisierung}}

\hypertarget{aufgabenstellung}{%
\subsubsection{Aufgabenstellung:}\label{aufgabenstellung}}

Die Aufgabe besteht in der Darstellung von Daten im Kontext
geographischer Karten, z.B. Wahlkreise und der Anteil von Stimmen für
bestimmte Parteien und die Arbeitslosenquote in diesen Bezirken.

\hypertarget{einfuxfchrung}{%
\subsubsection{Einführung}\label{einfuxfchrung}}

Im Folgenden wird in die geographische Visualisierung mit R eingeführt.
Es werden die Grundlagen zum Darstellen von Daten in geographischem
Kontext behandelt sowie an zwei konkreten Beispielen vorgestellt. todo
mehr

\hypertarget{zeichnen-von-geographischen-karten}{%
\subsubsection{Zeichnen von geographischen
Karten}\label{zeichnen-von-geographischen-karten}}

Die Grundlage zum Zeichnen von geographischen Grenzen bilden die
sogenannten Shape-Files. In diesem Format lassen sich Geometriedaten
leicht darstellen. In diesem Projekt wird ein Shape-File zur Darstellung
der Grenzen der deutschen Bundesländer verwendet. Dieses
\href{https://gdz.bkg.bund.de/index.php/default/digitale-geodaten/verwaltungsgebiete/nuts-gebiete-1-250-000-stand-01-01-nuts250-01-01.html}{Shape-File}
wird von dem Bundesamt für Kartographie und Geodäsie bereitgestellt. Im
Folgenden Code-Ausschnitt wird das Shape-File eingelesen und
beispielhaft die darin enthaltenen Daten ausgegeben.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{map <-}\StringTok{ }\KeywordTok{st_read}\NormalTok{(}\StringTok{"data/2500_NUTS1.shp"}\NormalTok{, }\DataTypeTok{stringsAsFactors=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `2500_NUTS1' from data source `/Users/nahkusaidy/Documents/Repositories/GeoVisualisation/data/2500_NUTS1.shp' using driver `ESRI Shapefile'
## Simple feature collection with 16 features and 3 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 3280341 ymin: 5237533 xmax: 3921264 ymax: 6103334
## epsg (SRID):    31467
## proj4string:    +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +towgs84=598.1,73.7,418.2,0.202,0.045,-2.455,6.7 +units=m +no_defs
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{map =}\StringTok{ }\KeywordTok{st_transform}\NormalTok{(map,}\DecValTok{3857}\NormalTok{)}
\KeywordTok{ggplot}\NormalTok{(map) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_sf}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{geoVisualisation_markdown_files/figure-latex/import shape-1.pdf}

Neben reinen Shape-Files gibt es in R die Möglichkeit auch todo
``realistischere'' Karten zu zeichnen. Hier wird beispielhaft eine Karte
von Deutschland von \href{https://www.openstreetmap.de}{OpenStreetMap}
gezeichnet.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{germany_map <-}\StringTok{ }\KeywordTok{get_map}\NormalTok{(}\KeywordTok{getbb}\NormalTok{(}\StringTok{"Deutschland"}\NormalTok{, }\DataTypeTok{base_url =} \StringTok{"https://nominatim.openstreetmap.org"}\NormalTok{, }\DataTypeTok{featuretype =} \StringTok{"country"}\NormalTok{),}\DataTypeTok{maptype =} \StringTok{"watercolor"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## maptype = "watercolor" is only available with source = "stamen".
\end{verbatim}

\begin{verbatim}
## resetting to source = "stamen"...
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/66/40.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/67/40.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/68/40.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/69/40.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/66/41.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/67/41.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/68/41.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/69/41.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/66/42.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/67/42.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/68/42.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/69/42.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/66/43.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/67/43.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/68/43.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/69/43.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/66/44.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/67/44.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/68/44.png
\end{verbatim}

\begin{verbatim}
## Source : http://tile.stamen.com/terrain/7/69/44.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggmap}\NormalTok{(germany_map)}
\end{Highlighting}
\end{Shaded}

\includegraphics{geoVisualisation_markdown_files/figure-latex/import openstreetmap2-1.pdf}

\hypertarget{binnenwanderung}{%
\subsubsection{Binnenwanderung}\label{binnenwanderung}}

Um die Möglichkeiten der Darstellung von Daten in geographischem Kontext
zu demonstrieren werden nun Daten aus einem Datensatz zur
Binnenwanderung in Deutschland analysiert und dargestellt. Dieser wird
zuerst importiert und die zu visualisierenden Daten in Data Frames
verpackt. Die Daten enthalten das Saldo der Binnenwanderung für jedes
Bundesland von Deutschen und Ausländern.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{binnenwanderung_data <-}\StringTok{ }\KeywordTok{read_excel}\NormalTok{(}\StringTok{"binnenwanderung.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## New names:
## * `` -> ...2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{states <-}\StringTok{ }\NormalTok{map}\OperatorTok{$}\NormalTok{NUTS_NAME}
\NormalTok{movement_per_state <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{ncol =} \DecValTok{16}\NormalTok{, }\DataTypeTok{nrow =} \DecValTok{16}\NormalTok{))}
\NormalTok{x <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"NUTS_NAME"}\NormalTok{,}\KeywordTok{sprintf}\NormalTok{(}\StringTok{"%s"}\NormalTok{,}\DecValTok{2003}\OperatorTok{:}\DecValTok{2017}\NormalTok{))}
\KeywordTok{colnames}\NormalTok{(movement_per_state) <-}\StringTok{ }\NormalTok{x}
\NormalTok{movement_per_state_mean <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{NUTS_NAME =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{16}\NormalTok{), }\DataTypeTok{Mean_Migration =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{16}\NormalTok{))}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(states))\{}
\NormalTok{  index <-}\StringTok{ }\KeywordTok{which}\NormalTok{(binnenwanderung_data }\OperatorTok{==}\StringTok{ }\NormalTok{states[i], }\DataTypeTok{arr.ind =} \OtherTok{TRUE}\NormalTok{)[}\DecValTok{1}\NormalTok{]}\OperatorTok{+}\DecValTok{2}
\NormalTok{  row_data =}\StringTok{ }\NormalTok{binnenwanderung_data[index,}\OperatorTok{-}\DecValTok{1}\OperatorTok{:-}\DecValTok{3}\NormalTok{]}
\NormalTok{  data_frame_row =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{c}\NormalTok{(states[i]), row_data)}
  \KeywordTok{names}\NormalTok{(data_frame_row) <-}\StringTok{ }\NormalTok{x}
\NormalTok{  movement_per_state[i,] =}\StringTok{ }\NormalTok{data_frame_row}
\NormalTok{  movement_per_state_mean}\OperatorTok{$}\NormalTok{NUTS_NAME[i] =}\StringTok{ }\NormalTok{states[i]}
\NormalTok{  movement_per_state_mean}\OperatorTok{$}\NormalTok{Mean_Migration[i] =}\StringTok{ }\KeywordTok{mean}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(row_data)))}
\NormalTok{\}}
\KeywordTok{str}\NormalTok{(movement_per_state)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    16 obs. of  16 variables:
##  $ NUTS_NAME: chr  "Baden-Württemberg" "Bayern" "Berlin" "Brandenburg" ...
##  $ 2003     : num  26926 34212 -7043 -498 673 ...
##  $ 2004     : num  22055 25695 -9133 742 1131 ...
##  $ 2005     : num  15394 29432 -4328 -522 810 ...
##  $ 2006     : num  5673 34153 1955 -3045 1371 ...
##  $ 2007     : num  10039 31477 7377 -4021 -292 ...
##  $ 2008     : num  12840 26151 12958 -4102 222 ...
##  $ 2009     : num  1070 15632 18353 -2173 1590 ...
##  $ 2010     : num  -1604 10746 17990 -1518 852 ...
##  $ 2011     : num  1054 15363 15341 -1596 -564 ...
##  $ 2012     : num  1880 15486 12134 1252 -378 ...
##  $ 2013     : num  -1315 14085 8068 4275 -635 ...
##  $ 2014     : num  -398 6677 2672 8921 -1910 ...
##  $ 2015     : num  1273 4011 -4628 12315 -3182 ...
##  $ 2016     : num  -4388 -1741 7891 9873 920 ...
##  $ 2017     : num  -5107 6593 -3013 14458 -2916 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{(movement_per_state_mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    16 obs. of  2 variables:
##  $ NUTS_NAME     : chr  "Baden-Württemberg" "Bayern" "Berlin" "Brandenburg" ...
##  $ Mean_Migration: num  5693 17865 5106 2291 -154 ...
\end{verbatim}

Diese Daten werden aufgesplittet in neue und alte Bundesländer, wobei
Berlin als altes Bundesland gezählt wird, da im Datensatz nicht zwischen
West- und Ostberlin unterschieden wird.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{new_states =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Brandenburg"}\NormalTok{,}\StringTok{"Mecklenburg-Vorpommern"}\NormalTok{,}\StringTok{"Sachsen"}\NormalTok{,}\StringTok{"Sachsen-Anhalt"}\NormalTok{,}\StringTok{"Thüringen")}
\StringTok{new_states_movement = movement_per_state[movement_per_state$NUTS_NAME %in% new_states,]}
\StringTok{new_states_movement = new_states_movement[1:5,]}
\StringTok{data_of_new_states = colSums(new_states_movement[,-1])}

\StringTok{`%notin%` <- Negate(`%in%`)}

\StringTok{old_states_movement = movement_per_state[movement_per_state$NUTS_NAME %notin% new_states,]}
\StringTok{old_states_movement = old_states_movement[1:11,]}
\StringTok{data_of_old_states = colSums(old_states_movement[,-1])}
\end{Highlighting}
\end{Shaded}

Im Folgenden wird der Vergleich des Saldos der Binnenwanderung zwischen
den neuen und alten Bundesländern zwischen 2003 und 2017 in einem Plot
dargestellt.

\includegraphics{geoVisualisation_markdown_files/figure-latex/plot binnenwanderung-1.pdf}

Es ist zu erkennen, dass die Abwanderung von Einwohnern von Ost- nach
Westdeutschland bis 2013 immer weiter abgenommen hat. Danach kam es 2014
erstmals zu einer Abwanderung von Einwohnern von West- nach
Ostdeutschland.

\end{document}
